"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[678],{782(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>p,frontMatter:()=>o,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"module-1/nodes-topics-services-rclpy","title":"ROS 2 Fundamentals & Python","description":"This chapter covers the three fundamental communication concepts in ROS 2: Nodes, Topics, and Services. We\'ll also see how to implement them using rclpy, the official Python client library for ROS 2.","source":"@site/docs/module-1/nodes-topics-services-rclpy.md","sourceDirName":"module-1","slug":"/module-1/nodes-topics-services-rclpy","permalink":"/ai-hackathon-1/docs/module-1/nodes-topics-services-rclpy","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/module-1/nodes-topics-services-rclpy.md","tags":[],"version":"current","frontMatter":{"id":"nodes-topics-services-rclpy","title":"ROS 2 Fundamentals & Python","sidebar_label":"Fundamentals & rclpy"},"sidebar":"tutorialSidebar","previous":{"title":"Feature Specification: Module 1 \u2014 The Robotic Nervous System (ROS 2)","permalink":"/ai-hackathon-1/docs/module-1/"},"next":{"title":"Introduction","permalink":"/ai-hackathon-1/docs/module-1/ros-2-basics-for-humanoid-control"}}');var i=s(4848),l=s(8453);const o={id:"nodes-topics-services-rclpy",title:"ROS 2 Fundamentals & Python",sidebar_label:"Fundamentals & rclpy"},t=void 0,c={},a=[{value:"1. ROS 2 Nodes",id:"1-ros-2-nodes",level:3},{value:"Example: A Simple <code>rclpy</code> Node",id:"example-a-simple-rclpy-node",level:4},{value:"2. ROS 2 Topics (Publish/Subscribe)",id:"2-ros-2-topics-publishsubscribe",level:3},{value:"Diagram: Publisher-Subscriber Model",id:"diagram-publisher-subscriber-model",level:4},{value:"Example: A Simple Publisher and Subscriber",id:"example-a-simple-publisher-and-subscriber",level:4},{value:"3. ROS 2 Services (Request/Response)",id:"3-ros-2-services-requestresponse",level:3},{value:"Diagram: Service Client/Server Model",id:"diagram-service-clientserver-model",level:4},{value:"Example: A Simple Service Server and Client",id:"example-a-simple-service-server-and-client",level:4}];function d(e){const n={code:"code",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["This chapter covers the three fundamental communication concepts in ROS 2: Nodes, Topics, and Services. We'll also see how to implement them using ",(0,i.jsx)(n.code,{children:"rclpy"}),", the official Python client library for ROS 2."]}),"\n",(0,i.jsx)(n.h3,{id:"1-ros-2-nodes",children:"1. ROS 2 Nodes"}),"\n",(0,i.jsxs)(n.p,{children:["A ",(0,i.jsx)(n.strong,{children:"Node"})," is the smallest, most fundamental unit of a ROS 2 system. Think of a node as a single, independent process in your robot's software architecture. Each node should have a single, well-defined purpose."]}),"\n",(0,i.jsx)(n.p,{children:"For a humanoid robot, you might have nodes for:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Reading sensor data from an IMU."}),"\n",(0,i.jsx)(n.li,{children:"Controlling the motors in the right leg."}),"\n",(0,i.jsx)(n.li,{children:"Processing camera images."}),"\n",(0,i.jsx)(n.li,{children:"Planning footsteps for walking."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Nodes are what allow ROS 2 systems to be modular and fault-tolerant. If one node crashes, the rest of the system can continue to run."}),"\n",(0,i.jsxs)(n.h4,{id:"example-a-simple-rclpy-node",children:["Example: A Simple ",(0,i.jsx)(n.code,{children:"rclpy"})," Node"]}),"\n",(0,i.jsxs)(n.p,{children:['Here is the "hello world" of ',(0,i.jsx)(n.code,{children:"rclpy"}),": a simple node that initializes itself, prints a message, and then shuts down."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# 'hello_node.py'\nimport rclpy\nfrom rclpy.node import Node\n\ndef main(args=None):\n    # 1. Initialize the rclpy library\n    rclpy.init(args=args)\n\n    # 2. Create a Node\n    #    The node is named 'hello_ros_node'\n    node = Node('hello_ros_node')\n\n    # 3. From this point, the node is running.\n    #    You can add your logic here.\n    node.get_logger().info('Hello, ROS 2 World!')\n\n    # 4. The node is destroyed when the 'with' statement exits.\n    #    This is important for cleanup.\n    node.destroy_node()\n    \n    # 5. Shutdown the rclpy library\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"To run this code:"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Save it as ",(0,i.jsx)(n.code,{children:"hello_node.py"}),"."]}),"\n",(0,i.jsx)(n.li,{children:"Make sure you have a ROS 2 environment sourced."}),"\n",(0,i.jsxs)(n.li,{children:["Run ",(0,i.jsx)(n.code,{children:"python hello_node.py"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"2-ros-2-topics-publishsubscribe",children:"2. ROS 2 Topics (Publish/Subscribe)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Topics"})," are the primary mechanism for one-way, asynchronous communication in ROS 2. Nodes can ",(0,i.jsx)(n.strong,{children:"publish"})," messages to a topic, and other nodes can ",(0,i.jsx)(n.strong,{children:"subscribe"})," to that topic to receive those messages. This is a decoupled communication model; publishers and subscribers don't need to know about each other."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Use Case:"})," Continuously streaming data, like sensor readings or motor commands."]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"diagram-publisher-subscriber-model",children:"Diagram: Publisher-Subscriber Model"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-mermaid",children:"graph TD\n    A[Publisher Node] -- Publishes message --\x3e B(Topic: /sensor_data);\n    B -- Message is delivered --\x3e C[Subscriber Node 1];\n    B -- Message is delivered --\x3e D[Subscriber Node 2];\n"})}),"\n",(0,i.jsx)(n.h4,{id:"example-a-simple-publisher-and-subscriber",children:"Example: A Simple Publisher and Subscriber"}),"\n",(0,i.jsx)(n.p,{children:"First, we define a publisher node that sends a simple string message every second."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# 'publisher_node.py'\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass SimplePublisher(Node):\n    def __init__(self):\n        super().__init__('simple_publisher')\n        # Create a publisher on the 'chatter' topic\n        self.publisher_ = self.create_publisher(String, 'chatter', 10)\n        self.timer = self.create_timer(1.0, self.timer_callback)\n        self.i = 0\n\n    def timer_callback(self):\n        msg = String()\n        msg.data = f'Hello from publisher: {self.i}'\n        self.publisher_.publish(msg)\n        self.get_logger().info(f'Publishing: \"{msg.data}\"')\n        self.i += 1\n\ndef main(args=None):\n    rclpy.init(args=args)\n    publisher = SimplePublisher()\n    rclpy.spin(publisher) # Keep the node alive\n    publisher.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Next, a subscriber node that listens to the ",(0,i.jsx)(n.code,{children:"chatter"})," topic."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# 'subscriber_node.py'\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import String\n\nclass SimpleSubscriber(Node):\n    def __init__(self):\n        super().__init__('simple_subscriber')\n        # Create a subscription to the 'chatter' topic\n        self.subscription = self.create_subscription(\n            String,\n            'chatter',\n            self.listener_callback,\n            10)\n        self.subscription  # prevent unused variable warning\n\n    def listener_callback(self, msg):\n        self.get_logger().info(f'I heard: \"{msg.data}\"')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    subscriber = SimpleSubscriber()\n    rclpy.spin(subscriber)\n    subscriber.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"To run this example:"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Open two terminals with your ROS 2 environment sourced."}),"\n",(0,i.jsxs)(n.li,{children:["In the first terminal, run ",(0,i.jsx)(n.code,{children:"python publisher_node.py"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["In the second terminal, run ",(0,i.jsx)(n.code,{children:"python subscriber_node.py"}),". You will see the messages from the publisher being received."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"3-ros-2-services-requestresponse",children:"3. ROS 2 Services (Request/Response)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Services"})," are for two-way, synchronous communication. A ",(0,i.jsx)(n.strong,{children:"Service Server"})," node provides a service, and a ",(0,i.jsx)(n.strong,{children:"Service Client"})," node can send a request and wait for a response. This is a tightly coupled, blocking communication model."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Use Case:"}),' Triggering a specific action that has a clear start and end, like "open gripper" or "calculate inverse kinematics".']}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"diagram-service-clientserver-model",children:"Diagram: Service Client/Server Model"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-mermaid",children:"graph TD\n    A[Service Client Node] -- Sends Request --\x3e B(Service: /add_two_ints);\n    B -- Delivers Request --\x3e C[Service Server Node];\n    C -- Processes and sends Response --\x3e B;\n    B -- Delivers Response --\x3e A;\n"})}),"\n",(0,i.jsx)(n.h4,{id:"example-a-simple-service-server-and-client",children:"Example: A Simple Service Server and Client"}),"\n",(0,i.jsxs)(n.p,{children:["First, the server node that offers a service to add two integers. ROS 2 has a standard service definition for this, ",(0,i.jsx)(n.code,{children:"example_interfaces/srv/AddTwoInts"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# 'service_server_node.py'\nimport rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import AddTwoInts\n\nclass SimpleServiceServer(Node):\n    def __init__(self):\n        super().__init__('simple_service_server')\n        # Create a service named 'add_two_ints'\n        self.srv = self.create_service(AddTwoInts, 'add_two_ints', self.add_two_ints_callback)\n\n    def add_two_ints_callback(self, request, response):\n        response.sum = request.a + request.b\n        self.get_logger().info(f'Incoming request: a={request.a}, b={request.b}. Returning sum={response.sum}')\n        return response\n\ndef main(args=None):\n    rclpy.init(args=args)\n    server = SimpleServiceServer()\n    rclpy.spin(server)\n    server.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.p,{children:"Next, the client node that calls the service."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# 'service_client_node.py'\nimport rclpy\nfrom rclpy.node import Node\nfrom example_interfaces.srv import AddTwoInts\nimport sys\n\nclass SimpleServiceClient(Node):\n    def __init__(self):\n        super().__init__('simple_service_client')\n        # Create a client for the 'add_two_ints' service\n        self.client = self.create_client(AddTwoInts, 'add_two_ints')\n        while not self.client.wait_for_service(timeout_sec=1.0):\n            self.get_logger().info('Service not available, waiting again...')\n        self.req = AddTwoInts.Request()\n\n    def send_request(self, a, b):\n        self.req.a = a\n        self.req.b = b\n        self.future = self.client.call_async(self.req)\n        rclpy.spin_until_future_complete(self, self.future)\n        return self.future.result()\n\ndef main(args=None):\n    rclpy.init(args=args)\n    if len(sys.argv) != 3:\n        print(\"Usage: python service_client_node.py <int1> <int2>\")\n        return\n\n    client = SimpleServiceClient()\n    response = client.send_request(int(sys.argv[1]), int(sys.argv[2]))\n    \n    if response:\n        client.get_logger().info(\n            f'Result of add_two_ints: for {sys.argv[1]} + {sys.argv[2]} = {response.sum}')\n    else:\n        client.get_logger().error('Service call failed')\n    \n    client.destroy_node()\n    rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"To run this example:"})}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Open two terminals with your ROS 2 environment sourced."}),"\n",(0,i.jsxs)(n.li,{children:["In the first, run ",(0,i.jsx)(n.code,{children:"python service_server_node.py"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["In the second, run ",(0,i.jsx)(n.code,{children:"python service_client_node.py 5 10"}),". The client will send the request and print the response."]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453(e,n,s){s.d(n,{R:()=>o,x:()=>t});var r=s(6540);const i={},l=r.createContext(i);function o(e){const n=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);